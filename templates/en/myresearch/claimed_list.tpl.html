{literal}
<script type="text/javascript">
<!--
function notMine(pid)
{
	if (confirm('You are about to mark this record as not belonging to you. Proceed?')) {
		document.getElementById('not-mine-pid').value = pid;
		document.forms['notMine'].submit();
	}
    
    return;
}

function notMineBulk()
{
	frm = document.getElementById('claimedForm');
	count = 0;
	pids = [];
	for (i = 0; i < frm.pid.length; i++) {
		if (frm.pid[i].checked) {
			pids.push(frm.pid[i].value);
			count++;
		}
	}
	
	if (count == 0) {
		window.alert('No records were marked for deletion.');
		return;
	}
	
	if (confirm('You are about to mark the ticked records as not belonging to you. Proceed?')) {
		document.getElementById('bulk-not-mine-pids').value = pids;
		document.forms['claimedForm'].submit();
	}
	
	return;
}

function correctionRequired(pid)
{
	document.getElementById('correction-pid').value = pid;
	document.forms['correctMe'].submit();
	
	return;
}

//-->
</script>
{/literal}

<h1>My Claimed Research</h1>

{if $isUPO}
	{include file="myresearch/acting.tpl.html"}
{/if}

<form action="{$rel_url}my_research_claimed.php" method="post" id="claimedForm">

	{section name="i" loop=$list}
	
		{assign var=pid value=$list[i].rek_pid}
	
		{if $smarty.section.i.first}
			<p>The publications listed below are currently claimed by you.</p>
			<table id="research-record-listing">
		{/if}
	
		<tr class="{if $flagged[$pid].type == 'D'}claimed-not-my-pub{elseif $flagged[$pid].type == 'C'}claimed-correction-required{/if}">
			<td style="width: 10px;"><input type="checkbox" name="pid" value="{$list[i].rek_pid}" /></td>
			<td style="width: 100%;">{$list[i].rek_citation}</td>
			<td {*style="background: #ffffff; border: none;"*}>
				{if $flagged[$pid].type == 'D'}
					<div class="research-record-note">You have indicated that this record does not belong to you. A job has been logged with the {$app_name} team.</div>
				{elseif $flagged[$pid].type == 'C'}
					<div class="research-record-note">You have indicated that this record is yours, but requires a correction. A job has been logged with the {$app_name} team.</div>
				{/if}
				
				{if $flagged[$pid].type != 'D'}
					<input type="button" class="claimed-not-my-pub" value="This is not my publication" onclick="javascript:notMine('{$list[i].rek_pid}');" /><br />
				{/if}
				{if $flagged[$pid].type != 'C'}
					<input type="button" class="claimed-correction-required" value="This is my publication, but a correction is required" onclick="javascript:correctionRequired('{$list[i].rek_pid}');" />
				{/if}
			</td>
		</tr>
		
		{if $smarty.section.i.last}
			</table>
			
			<div>
				<input type="button" class="claimed-not-my-pub" value="None of the above ticked publications are mine" onclick="javascript:notMineBulk();" />
			</div>
			
			<div>
				<input type="hidden" id="bulk-not-mine-pids" name="bulk-not-mine-pids" value="" />
				<input type="hidden" name="action" value="not-mine-bulk" />
			</div>
		{/if}
		
	{sectionelse}
		<p>We could not find any publications authored by you.</p>
	{/section}
	
</form>

<form action="{$rel_url}my_research_claimed.php" method="post" id="notMine">	
	<div>
		<input type="hidden" id="not-mine-pid" name="pid" value="" />
		<input type="hidden" name="action" value="not-mine" />
	</div>
</form>

<form action="{$rel_url}my_research_claimed.php" method="post" id="correctMe">	
	<div>
		<input type="hidden" id="correction-pid" name="pid" value="" />
		<input type="hidden" name="action" value="correction" />
	</div>
</form>
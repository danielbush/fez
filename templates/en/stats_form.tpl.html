{literal}
<script language="JavaScript">
<!--
var page_url = '{/literal}{$smarty.server.PHP_SELF}{literal}';
var current_page = {/literal}{if $list_info.current_page != ""}{$list_info.current_page}{else}0{/if}{literal};
var last_page = {/literal}{if $list_info.last_page != ""}{$list_info.last_page}{else}0{/if}{literal};
function assignItems(f)
{
    if (!hasOneChecked(f, 'item[]')) {
        alert('Please choose which entries to assign.');
        return false;
    }
    if (f.users.options[f.users.selectedIndex].value == '') {
        alert('Please choose the user to assign these entries to.');
        f.users.focus();
        selectField(f, 'users');
        return false;
    }
    var features = 'width=420,height=200,top=30,left=30,resizable=no,scrollbars=yes,toolbar=no,location=no,menubar=no,status=no';
    var popupWin = window.open('', '_popup', features);
    popupWin.focus();
    f.action = 'popup.php';
    f.target = '_popup';
    f.submit();
}

function createRecord(f) {
    f.action = 'new.php';
	f.submit();
}

function hideClosed(f)
{
    if (f.hide_closed.checked) {
        window.location.href = page_url + "?" + replaceParam(window.location.href, 'hide_closed', '1');
    } else {
        window.location.href = page_url + "?" + replaceParam(window.location.href, 'hide_closed', '0');
    }
}
function resizePager(f)
{
    var pagesize = f.page_size.options[f.page_size.selectedIndex].value;
    window.location.href = page_url + "?" + replaceParam(window.location.href, 'rows', pagesize);
}
function checkPageField(ev)
{
    // check if the user is trying to submit the form by hitting <enter>
    if (((window.event) && (window.event.keyCode == 13)) ||
            ((ev) && (ev.which == 13))) {
        return false;
    }
}
function goPage(f, new_page)
{
    if ((new_page > last_page+1) || (new_page <= 0) ||
            (new_page == current_page+1) || (!isNumberOnly(new_page))) {
        f.page.value = current_page+1;
        return false;
    }
    setPage(new_page-1);
}
function setPage(new_page)
{
    if ((new_page > last_page) || (new_page < 0) ||
            (new_page == current_page)) {
        return false;
    }
    window.location.href = page_url + "?" + replaceParam(window.location.href, 'pagerRow', new_page);
}
function downloadCSV()
{
    var f = this.document.csv_form;
    f.submit();
    return false;
}
//window.onload = disableFields;
function disableFields()
{
    var f = document.list_form;
    if (current_page == 0) {
        f.first.disabled = true;
        f.previous.disabled = true;
    }
    if ((current_page == last_page) || (last_page <= 0)) {
        f.next.disabled = true;
        f.last.disabled = true;
    }
    if ((current_page == 0) && (last_page <= 0)) {
        f.page.disabled = true;
        f.go.disabled = true;
    }
}



//-->
</script>
{/literal}

{literal}
<script language="JavaScript">
<!--
function purgeObject(pid)
{
    if (!confirm('This action will permanently delete the selected object.')) {
        return false;
    } else {
        var features = 'width=420,height=200,top=30,left=30,resizable=yes,scrollbars=yes,toolbar=no,location=no,menubar=no,status=no';
        var popupWin = window.open('popup.php?cat=purge_object&pid=' + pid, '_popup', features);
        popupWin.focus();
    }
}
//-->
</script>
{/literal}
<table width="100%" bgcolor="{$cell_color}" cellspacing="0" cellpadding="1" align="center">
  <form name="list_form" method="get" action="{$smarty.server.PHP_SELF}">
  <input type="hidden" name="cat" value="assign">
  <tr>
    <td>
      <table bgcolor="#FFFFFF" width="100%" cellspacing="1" cellpadding="2" >

		{if $list_type == 'collection_records_list'}
		<tr>
		  <td align="left"> <br />
			<table bgcolor="#FFFFFF" border="0" cellspacing="0" cellpadding="1">
				<tr>
				  <td align="left" class="default"> <b>Parent Communities: </b></td>
				  <td align="left" class="default"> &nbsp;
					{section name="i" loop=$parents}
						<a href="list.php?community_pid={$parents[i].pid}">{$parents[i].title}</a> &nbsp;
					{/section}
				  </td>
				</tr>
			</table>
		  </td>
		</tr>
		{/if}

        <tr><td align="center">
      <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1">
		{if ($browse_type == "browse_top50authors") || ($browse_type == "browse_top50papers") || ($browse_type == "browse_show_detail_date")} 
		 <tr class="default">
			<td class="contentheader"><img src="{$rel_url}images/statistics_22.gif" alt="" align="absmiddle"> Access Statistics: <a href="{$rel_url}view.php?pid={$pid}">{$title}</a>
			</td>
		</tr>

		 <tr class="default">
			<td>
			<p>
			<p><strong>Most viewed records:</strong>
			[<a href="{$rel_url}stats.php?browse=show_detail_date&range=4w">Past four weeks</a>] 
			[<a href="{$rel_url}stats.php?browse=show_detail_date&year={$thisYear}">This year</a>]
			[<a href="{$rel_url}stats.php?browse=show_detail_date&year={$lastYear}">Last year</a>]
			[<a href="{$rel_url}stats.php?browse=show_detail_date">All years</a>]
			<br /><br /><strong>Repository-wide statistics:</strong>
			[<a href="{$rel_url}stat_details.php?action=cumulative_usage&range=all">by Year/month</a>] 
			[<a href="{$rel_url}stat_details.php?action=cumulative_usage_country">by Country</a>] 
			<p>
			</td>
		</tr>
		{/if}
		{if ($browse_type == "browse_top50authors")} 
        <tr>
			<td align="left" class="default"><br />
			<a href="{$rel_url}list.php?browse=author"><img border="0" src="{$rel_url}images/browse_32.jpg" align="absmiddle"/></a>
           &nbsp;<b>{$browse_heading}:</b>		  
			</td>
        </tr>
		   {if $smarty.get.author == ""}
			{section name="i" loop=$list}

			  <tr>
				  <td>
				  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
				  <tr>
						<td align="right" width="10">{$smarty.section.i.index+1}</td>
					  <td align="left">
							<a href='{$rel_url}list.php?browse=author&author={$list[i].record_author}'>{$list[i].record_author|escape:"html"}</a> 

						</td>
						<td align="right" nowrap>(<strong>{$list[i].file_downloads|escape:"html"}</strong> File Downloads)</td>
					</tr>
					  </table>
					<!-- space between rows -->
				</td>
				</tr>

			{sectionelse}
			<tr>
			<td>
			  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
			<tr><td>
				No authors could be found.
			</td></tr>
			</table>
						</td>
				</tr>
			{/section}
			{/if}
		{elseif ($browse_type == "browse_show_detail_date")} 
        <tr>
			<td align="left" class="default"><br />
			<img border="0" src="{$rel_url}images/browse_32.jpg" align="absmiddle"/>
           &nbsp;<b>{$browse_heading}:</b>		  
			</td>
        </tr>
			{section name="i" loop=$list}
			{if $list[i].file_downloads > 0}
			  <tr>
				  <td>
				  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
				  <tr>
						<td align="right" width="10">{$smarty.section.i.index+1}</td>
					  <td align="left">
							<a href='{$rel_url}view.php?pid={$list[i].pid}'>{$list[i].title.0|escape:"html"}</a> 

						</td>
						<td align="right" nowrap>(<strong>{$list[i].file_downloads|escape:"html"}</strong> <a href="{$rel_url}stat_details.php?action=show_detail&pid={$list[i].pid}">File Downloads</a>)</td>
					</tr>
					  </table>
					<!-- space between rows -->
				</td>
				</tr>
			{/if}
			{sectionelse}
			<tr>
			<td>
			  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
			<tr><td>
				No papers could be found.
			</td></tr>
			</table>
						</td>
				</tr>
			{/section}

		{elseif ($browse_type == "browse_top50papers")} 
        <tr>
			<td align="left" class="default"><br />
			<img border="0" src="{$rel_url}images/browse_32.jpg" align="absmiddle"/>
           &nbsp;<b>{$browse_heading}:</b>		  
			</td>
        </tr>
			{section name="i" loop=$list}
			{if $list[i].file_downloads > 0}
			  <tr>
				  <td>
				  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
				  <tr>
						<td align="right" width="10">{$smarty.section.i.index+1}</td>
					  <td align="left">
							<a href='{$rel_url}view.php?pid={$list[i].pid}'>{$list[i].title.0|escape:"html"}</a> 

						</td>
						<td align="right" nowrap>(<strong>{$list[i].file_downloads|escape:"html"}</strong> <a href="{$rel_url}stat_details.php?action=show_detail&pid={$list[i].pid}">File Downloads</a>)</td>
					</tr>
					  </table>
					<!-- space between rows -->
				</td>
				</tr>
			{/if}
			{sectionelse}
			<tr>
			<td>
			  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
			<tr><td>
				No papers could be found.
			</td></tr>
			</table>
						</td>
				</tr>
			{/section}

		{elseif ($browse_type == "browse_author")} 
        <tr>
			<td align="left" class="default"><br />
			<a href="{$rel_url}list.php?browse=author"><img border="0" src="{$rel_url}images/browse_32.jpg" align="absmiddle"/></a>
           &nbsp;<b>{$browse_heading}:</b>		  
			</td>
        </tr>
		   {if $smarty.get.author == ""}
			{section name="i" loop=$list}
			{if $list[i].file_downloads > 0}
			  <tr>
				  <td>
				  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
				  <tr>
					  <td>
							<a href='{$rel_url}list.php?browse=author&author={$list[i].record_author}'>{$list[i].record_author|escape:"html"}</a> ({$list[i].record_count|escape:"html"})

						</td>
					</tr>
					  </table>
					<!-- space between rows -->
				</td>
				</tr>
			{/if}
			{sectionelse}
			<tr>
			<td>
			  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
			<tr><td>
				No authors could be found.
			</td></tr>
			</table>
						</td>
				</tr>
			{/section}
			{/if}
		{elseif ($browse_type == "browse_year")} 
        <tr>
			<td align="left" class="default"><br />
			<a href="{$rel_url}list.php?browse=year"><img border="0" src="{$rel_url}images/browse_32.jpg" align="absmiddle"/></a>
           &nbsp;<b>{$browse_heading}:</b>		  
			</td>
        </tr>
		   {if $smarty.get.year == ""}
			{section name="i" loop=$list}

			  <tr>
				  <td>
				  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
				  <tr>
					  <td>
							<a href='{$rel_url}list.php?browse=year&year={$list[i].record_year}'>{$list[i].record_year|escape:"html"}</a> ({$list[i].record_count|escape:"html"})

						</td>
					</tr>
					  </table>
					<!-- space between rows -->
				</td>
				</tr>

			{sectionelse}
			<tr>
			<td>
			  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
			<tr><td>
				No records with saved dates could be found.
			</td></tr>
			</table>
						</td>
				</tr>
			{/section}
			{/if}
		{elseif $browse_type == "browse_subject"}
        <tr>
			<td align="left" class="default"><br />
			<a href="{$rel_url}list.php?browse=subject"><img border="0" src="{$rel_url}images/browse_32.jpg" align="absmiddle"/></a>
           &nbsp;<b>Browse by 
		          {if $max_subject_breadcrumb != -1}
					  {section name="b" loop=$subject_breadcrumb}
						  {assign var="counter" value=b}
		                  {if $subject_breadcrumb[b].cvo_image_filename != ""}
						    <img align="absmiddle" src="{$rel_url}images/{$subject_breadcrumb[b].cvo_image_filename}"/>
						  {/if}
                          {if $max_subject_breadcrumb != $smarty.section.b.index}<a href='{$rel_url}list.php?browse=subject&parent_id={$subject_breadcrumb[b].cvo_id}'>{else}<b>{/if}{$subject_breadcrumb[b].cvo_title|escape:"html"}{if $max_subject_breadcrumb != $smarty.section.b.index}</a>{else}</b>{/if}
 						  {assign var="cvo_id" value=$subject_breadcrumb[b].cvo_id}
						  {if $subject_count[$cvo_id]}({$subject_count[$cvo_id]}){else}{/if}{if $max_subject_breadcrumb != $smarty.section.b.index}->{else}:{/if}					
					  {/section}
				   {else}Subject Classification:{/if}</b>		  
			</td>
        </tr>


        {section name="i" loop=$subject_list}
		  <tr>
			  <td>
			  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
              <tr>
                  <td>{if $subject_list[i].cvo_image_filename != ""}<img align="absmiddle" src="{$rel_url}images/{$subject_list[i].cvo_image_filename}"/>{/if}
                        <a href='{$rel_url}list.php?browse=subject&parent_id={$subject_list[i].cvo_id}'>{$subject_list[i].cvo_title|escape:"html"}</a>
						{assign var="cvo_id" value=$subject_list[i].cvo_id}
						{if $subject_count[$cvo_id]}({$subject_count[$cvo_id]}){else}(0){/if}
					</td>
				</tr>
				<tr>
                    <td>
						{$subject_list[i].cvo_desc}
                    </td>
                  </tr>
				  </table>
                <!-- space between rows -->
	        </td>
	        </tr>
        {sectionelse}
		<tr>
		<td>
		  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
        <tr><td>
            No further child subject classifications could be found.
        </td></tr>
        </table>
			        </td>
	        </tr>
		{/section}
		{/if}		
		{if ($browse_heading == "") || ($browse_type != "" & $smarty.get.author != "") || ($browse_type != "" & $smarty.get.year != "" && $browse_type != "browse_show_detail_date") || ($browse_type != "" && $parent_id != "" && $max_subject_breadcrumb != 0)} 
        <tr>
			<td align="left" class="default"><br />
		{if $list_type == 'all_records_list' || $list_type == 'collection_records_list'}
			<img src="{$rel_url}images/record_32.jpg" align="absmiddle"/>		
		{elseif $list_type == 'community_list'}
			<img src="{$rel_url}images/community_32.jpg" align="absmiddle"/>
		{elseif $list_type == 'collection_list'}
			<img src="{$rel_url}images/collection_32.jpg" align="absmiddle"/>
		{elseif $list_type == 'browse_subjects_list'}		

		{/if}
           &nbsp;<b>{$list_heading}: </b>
		   
		   <b>({$list_info.total_rows} results found{if $list_info.end_offset > 0}, {math equation="x + 1" x=$list_info.start_offset} - {$list_info.end_offset} shown{/if}) ({$list_info.hidden_rows} hidden)</b>
</td>
        </tr>

        {section name="i" loop=$list}
        {if (($list[i].isLister==1 || $isAdministrator) && $list_type != 'browse_subjects_list')}
	   		{if $list[i].ret_id == '1'}
                {assign var="href_view" value="list.php?community_pid="|cat:$list[i].pid|escape:"html"}
                {assign var="icon" value="images/community.jpg" }
                {if ($list[i].isEditor==1 || $isAdministrator)} 
                        {assign var="showEdit" value=true}
                {else}
                        {assign var="showEdit" value=false}
                {/if}
           {elseif $list[i].ret_id == '2'}
                {assign var="href_view" value="list.php?collection_pid="|cat:$list[i].pid|escape:"html"}
                {assign var="icon" value="images/collection.jpg" }
                {if $isUser && ($list[i].isEditor==1 || $isAdministrator)}  
                        {assign var="showEdit" value=true}
                {else}
                        {assign var="showEdit" value=false}
                {/if}
           {else}
                {if ($list[i].isViewer==1 || $isAdministrator)}
                  {assign var="href_view" value="view.php?pid="|cat:$list[i].pid|escape:"html"}
                {else}
                  {assign var="href_view" value=""}
                {/if}
				{if $list[i].thumbnail != "0" && $list[i].isViewer==1}
	                {assign var="icon" value=$eserv_url|cat:"?pid="|cat:$list[i].pid|cat:"&dsID="|cat:$list[i].thumbnail}
				{else}
	                {assign var="icon" value="images/record.jpg" }
				{/if}
                {if $isUser && ($list[i].isEditor==1 || $isAdministrator)} 
                        {assign var="showEdit" value=true}
                {else}
                        {assign var="showEdit" value=false}
                {/if}
           {/if}
		  <tr>

			  <td>
			  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
              <tr>

                  <td>
                        {if $href_view}<a href='{$href_view}' >{/if}<img align="absmiddle" 
                        src="{$icon}" border="0">{if $href_view}</a>{/if} 

                    {if $href_view}<a href='{$href_view}'>{/if}
					{$list[i].title|escape:"html"}{if $href_view}</a>{/if}
					  {if $showEdit || $isAdministrator}
						{if $showEdit}
							&nbsp;&nbsp;<a href='update.php?pid={$list[i].pid|escape:"html"}'><img title="Edit" align="absmiddle" src="{$rel_url}images/edit.gif" border="0"></a> 
						{/if}
						{if $isAdministrator}
							 <a href='javascript:void(null);' onClick="javascript:purgeObject('{$list[i].pid|escape:"html"}');"><img title="Delete" align="absmiddle" src="{$rel_url}images/delete.gif" border="0"></a> 
						{/if}

					  {/if}

					</td>
				</tr>
				<tr>
                    <td>
                       {if $list[i].creator}{$list[i].creator|escape:"html"}<br />{/if}
                       {if $list[i].description}{$list[i].description|escape:"html"}...<br />{/if}
                       {if $list[i].date}{$list[i].date|date_format:"%A, %B %e, %Y"}<br />{/if}
                       {if $list[i].type}{$list[i].type|escape:"html"}<br />{/if}   
					   {if $list[i].ret_id == '3'}<b>Datastreams:</b> {section name="d" loop=$list[i].datastreams}{if $href_view}<a href="{$eserv_url|cat:"?pid="|cat:$list[i].pid|cat:"&dsID="|cat:$list[i].datastreams[d]}">{/if}{$list[i].datastreams[d]}{if $href_view}</a>{/if} {/section}{/if}
                    </td>
                  </tr>
				  </table>
                <!-- space between rows -->
	        </td>
	        </tr>
	 {else}


	 {/if}
	 

        {sectionelse}
		<tr>
		<td>
		  <table bgcolor="#FFFFFF" width="100%" cellpadding="2" cellspacing="1" class="listrecord">
        <tr><td>
            No records could be found.
        </td></tr>
        </table>
			        </td>
	        </tr>
        {/section}
		{/if}


		</table>
        </td>
        </tr>
		{if $isUser}
        <tr>
          <td align="left" >
			{if $list_type == 'community_list' && $isAdministrator}
			<br /> <a class="default" target="_top" title="create a new community" href="{$rel_url}new.php?xdis_id={$xdis_id}"><img align="absmiddle" src="{$rel_url}images/folder_new.gif" border="0"><b>Create New Community</b></a>&nbsp;
			{elseif $list_type == 'collection_list' && ($isAdministrator || $isCreator)}
			<br /> <a class="default" target="_top" title="create a new collection" href="{$rel_url}new.php?xdis_id={$xdis_id}{if $community_pid}&community_pid={$community_pid}{/if}"><img align="absmiddle" src="{$rel_url}images/folder_new.gif" border="0"><b>Create New Collection</b></a>&nbsp;
			{elseif ($list_type == 'collection_records_list' && ($isAdministrator || $isCreator)) && $browse_type == ""}
				{if $childXDisplayOptions != 0}
			<br /> <img align="absmiddle" src="{$rel_url}images/folder_new.gif" border="0">
				<input type="hidden" name="collection_pid" value="{$collection_pid}">
				<select name="xdis_id" class="default">
				  {html_options options=$childXDisplayOptions}
				</select>
				<input class="default" type="button" value="Create" onClick="javascript:createRecord(this.form)">
			&nbsp;<br />
				{/if}
			<br /> <a class="default" target="_top" title="batch import" href="{$rel_url}batchimport.php?xdis_id={$xdis_id}{if $collection_pid}&collection_pid={$collection_pid}{/if}"><img align="absmiddle" src="{$rel_url}images/scanner_22.jpg" border="0"><b>Batch Import Records from SAN</b></a>&nbsp;
			{/if}
		  </td>
        </tr>
		{/if}


      </table>
    </td>
  </tr>
  </form>
</table>

